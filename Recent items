<?xml version="1.0" encoding="UTF-8"?>
<extensionAttribute>
	<displayName>OS - Number Of Recent Applications To Remember</displayName>
	<displayInCategory>Security Reporting</displayInCategory>
	<dataType>string</dataType>
	<description>This extension attribute will verify the number of recent applications the Finder will remember.  The value to be verified will need to be specified when creating this extension attribute.  Example: "0" means that no recent applications will be remembered.  This extension attribute requires this preference be set using Managed Preferences (MCX).</description>
	<scriptContentsMac>#!/bin/sh
desiredValue="EditFromTemplate_Desired_Value_-_Example:_0"

appDomain="com.apple.recentitems"
keyName="Applications"
currentUser=`last -1 -t console | awk '{print $1}'`
result="`dscl . mcxread /Users/$currentUser \"$appDomain\" \"$keyName\" |grep MaxAmount | sed -e 's/;//g'| sed -e 's/ //g'| sed -e 's/MaxAmount=//g'`"

if [ "$result" == "$desiredValue" ]; then
echo "&lt;result&gt;Pass ($result) &lt;/result&gt;"
else
echo "&lt;result&gt;Fail ($result) &lt;/result&gt;"
fi
	</scriptContentsMac>
</extensionAttribute>
